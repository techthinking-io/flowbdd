<!--
  ~ Flow BDD - The most productive way to test.
  ~ Copyright (C) 2021-2025 James Bayliss.
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with this program.  If not, see <https://www.gnu.org/licenses/>.
  -->

<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FlowBDD Server - Home</title>
  <style>
    body { font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 0; display: flex; flex-direction: column; min-height: 100vh; }
    header, footer { background: #333; color: white; padding: 1rem 2rem; }
    header nav a, footer a { color: #eee; margin-right: 1rem; text-decoration: none; }
    header nav a:hover, footer a:hover { text-decoration: underline; }
    main { flex: 1; padding: 2rem; }
    .hero { background: #eee; padding: 2rem; border-radius: 8px; margin-bottom: 2rem; }
    .suite-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem; }
    .suite-card { border: 1px solid #ddd; padding: 1rem; border-radius: 8px; }
    .footer-links { margin-top: 0.5rem; }
  </style>
</head>
<body>

<header>
  <nav>
    <a href="/">Home</a>
    <a href="/reports/index.html">Last Report</a>
    <a href="/runner/index.html">Test Runner</a>
  </nav>
</header>

<main>
  <div class="hero">
    <h1>Welcome to FlowBDD Server</h1>
    <p>Efficiently run and analyze your Behavior-Driven Development tests.</p>
  </div>

  <h2>Available Test Suites</h2>
  <div id="suitesContainer" class="suite-grid">
    <p>Loading suites...</p>
  </div>
</main>

<footer>
  <div>&copy; 2021-2025 James Bayliss. Flow BDD - The most productive way to test.</div>
  <div class="footer-links">
    <a href="https://techthinking.io" target="_blank">techthinking.io</a>
    <a href="https://github.com/tech-thinking-io/flowbdd" target="_blank">GitHub Repo</a>
  </div>
</footer>

<script>
  async function loadSuites() {
    const container = document.getElementById('suitesContainer');
    try {
      const res = await fetch('/api/report/index');
      if (!res.ok) {
        container.innerHTML = '<p>No report found. Use the <a href="/runner/index.html">Test Runner</a> to run some tests manually.</p>';
        return;
      }
      const index = await res.json();
      if (index.links && index.links.testSuites && index.links.testSuites.length > 0) {
        container.innerHTML = index.links.testSuites.map(s => {
          const classOnly = s.name.split('.').pop();
          return `
            <div class="suite-card">
              <h3><a href="/TEST-${s.name}">${classOnly}</a></h3>
              <p style="font-size: 0.8rem; color: #666;">${s.name}</p>
              <p><a href="/api/report/suite/${s.file}" target="_blank">View JSON Data</a></p>
            </div>
          `;
        }).join('');
      } else {
        container.innerHTML = '<p>No suites found in the latest report.</p>';
      }
    } catch (err) {
      console.error(err);
      container.innerHTML = '<p>Error loading suites.</p>';
    }
  }

  loadSuites();
</script>

</body>
</html>
